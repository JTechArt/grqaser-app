# Story 3.3: State management and data integration

## Status

Draft

## Story

**As a** developer,  
**I want** state (books, search, user preferences) and data services to be wired to the crawler-backed API or data export,  
**so that** the UI shows real catalog data.

## Acceptance Criteria

1. State management (e.g., Redux Toolkit) is configured with slices for books, audio, user, search.
2. Data services load books (list, by id, search) from the database-viewer API or agreed data source.
3. Loading and error states are handled; data is displayed on Home and Search.

## Tasks / Subtasks

- [ ] Task 1: Redux Toolkit and slices (AC: 1)
  - [ ] Configure Redux Toolkit with slices for books, audio, user, search ([Source: docs/architecture/grqaserapp-data-integration-and-audio.md], [Source: docs/architecture/tech-stack.md]).
  - [ ] Types align with [Source: docs/architecture/data-models-and-schema.md] (e.g. Book type).
- [ ] Task 2: Data services and API (AC: 2)
  - [ ] Implement data services that load books (list, by id, search) from database-viewer API or agreed data source ([Source: docs/architecture/grqaserapp-data-integration-and-audio.md]).
  - [ ] Base URL/config externalized; services used by store or components.
- [ ] Task 3: Loading, errors, and display (AC: 3)
  - [ ] Handle loading and error states in state and UI; display catalog data on Home and Search ([Source: docs/architecture/grqaserapp-data-integration-and-audio.md], [Source: docs/architecture/coding-standards.md] — clear user feedback for errors).
  - [ ] Network failures surfaced to user per NFR4 ([Source: docs/architecture/grqaserapp-data-integration-and-audio.md]).

## Dev Notes

### Previous Story Insights

Stories 3.1 and 3.2 provide project structure and navigation. This story wires state and API so Home and Search show real data; Story 3.4 will refine Home and book detail UI.

### Data Models

- **Books** and API response types aligned with [Source: docs/architecture/data-models-and-schema.md]. Data source: database-viewer REST API (list, by id, search) or agreed export.

### API Specifications

- Consume database-viewer API: `GET /api/v1/books`, `GET /api/v1/books/:id`, `GET /api/v1/books/search?q=...` ([Source: docs/architecture/database-viewer-api-and-deployment.md]). API base URL configurable.

### File Locations

- **State:** `GrqaserApp/src/state/` (or equivalent). **Services:** `GrqaserApp/src/services/`. **Types:** `GrqaserApp/src/types/` ([Source: docs/architecture/source-tree.md]).

### Technical Constraints

- Redux Toolkit; TypeScript; handle network and playback errors with clear user feedback ([Source: docs/architecture/coding-standards.md], [Source: docs/architecture/grqaserapp-data-integration-and-audio.md]).

### Testing

- Unit/integration tests for state and services; mock API where appropriate ([Source: docs/architecture/testing-and-deployment-strategy.md]). Run: `npm test` from `GrqaserApp/`.

## Change Log

| Date       | Version | Description                    | Author       |
|-----------|---------|--------------------------------|--------------|
| 2025-02-14 | 1.0     | Story created from Epic 3     | Scrum Master |

## Dev Agent Record

### Agent Model Used

—

### Debug Log References

—

### Completion Notes List

—

### File List

—

## QA Results

—
