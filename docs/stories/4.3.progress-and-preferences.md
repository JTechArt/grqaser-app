# Story 4.3: Progress and preferences

## Status

Draft

## Story

**As a** user,  
**I want** my playback position and preferences (favorites, theme) to persist,  
**so that** I can resume and use the app my way across sessions.

## Acceptance Criteria

1. Playback position is saved and restored per book/session.
2. Favorites (or equivalent) can be toggled and persist.
3. Dark/light theme preference is supported and persisted.

## Tasks / Subtasks

- [ ] Task 1: Playback position persistence (AC: 1)
  - [ ] Save playback position per book/session; restore on reopen ([Source: docs/architecture/grqaserapp-data-integration-and-audio.md]).
  - [ ] Use AsyncStorage or equivalent per tech stack ([Source: docs/architecture/tech-stack.md]).
- [ ] Task 2: Favorites (AC: 2)
  - [ ] Implement favorites (or equivalent); toggle and persist ([Source: docs/architecture/grqaserapp-data-integration-and-audio.md]).
  - [ ] Store in Redux user slice and persist to AsyncStorage/local; restore on launch.
- [ ] Task 3: Dark/light theme (AC: 3)
  - [ ] Support dark/light theme preference; persist and apply across sessions ([Source: docs/architecture/grqaserapp-data-integration-and-audio.md], PRD FR13).
  - [ ] Store preference in user state and AsyncStorage; apply to app theme.

## Dev Notes

### Previous Story Insights

Stories 4.1 and 4.2 deliver core player and background/controls. This story adds persistence: position, favorites, theme.

### Data Models

- **User/preferences:** Favorites (book ids), theme (dark/light), playback position per book ([Source: docs/architecture/grqaserapp-data-integration-and-audio.md]). Storage: AsyncStorage or local ([Source: docs/architecture/tech-stack.md]).

### File Locations

- **State:** `GrqaserApp/src/state/` (user slice for favorites, theme). **Storage:** AsyncStorage or equivalent; may live in services or state layer ([Source: docs/architecture/source-tree.md]).

### Technical Constraints

- AsyncStorage/local for persistence; Redux Toolkit for in-memory state ([Source: docs/architecture/tech-stack.md], [Source: docs/architecture/grqaserapp-data-integration-and-audio.md]).

### Testing

- Unit tests for persistence logic; integration tests for restore on launch ([Source: docs/architecture/testing-and-deployment-strategy.md]). Run: `npm test` from `GrqaserApp/`.

## Change Log

| Date       | Version | Description                    | Author       |
|-----------|---------|--------------------------------|--------------|
| 2025-02-14 | 1.0     | Story created from Epic 4     | Scrum Master |

## Dev Agent Record

### Agent Model Used

—

### Debug Log References

—

### Completion Notes List

—

### File List

—

## QA Results

—
