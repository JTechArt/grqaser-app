# Implementation Readiness: Story 8.3

**See also:** [Implementation readiness for all stories](./implementation-readiness-all-stories.md).

**Story:** 8.3 — Database management from internet  
**Checked by:** Architect (Winston)  
**Date:** 2026-02-19

## Verdict: **READY**

The story is implementation-ready for the Dev agent. It adds full database management (load from URL, list, refresh, remove, switch active, reload) building on Story 8.1's SQLite infrastructure. All referenced architecture docs, design mockups, data models, and source paths exist. Tasks cover service, repository, Redux, DB connection re-init, UI, and testing thoroughly.

---

## 1. Architecture and reference integrity

| Check | Status | Notes |
|-------|--------|--------|
| All cited architecture docs exist | ✅ | grqaserapp-data-integration-and-audio (Data integration, DB management), data-models-and-schema (managed_databases), source-tree, tech-stack, coding-standards — all exist and updated for Epic 8 |
| Dev Notes match architecture content | ✅ | Load from URL, refresh alongside, active DB safeguard, catalog reload on switch — all match architecture |
| Source references accurate | ✅ | `[Source: architecture/...]` and `[Source: docs/design/...]` point to real sections |
| Phase scope correct | ✅ | Epic 8; prerequisite: Story 8.1 complete; can parallel with 8.2 |

---

## 2. File and project structure

| Check | Status | Notes |
|-------|--------|--------|
| New `databaseManager.ts` | ✅ | Path `src/services/databaseManager.ts` — services/ exists; file to be created |
| Modified `connection.ts` | ✅ | Created by 8.1; this story adds close/reopen on DB switch |
| Modified `catalogRepository.ts` | ✅ | Created by 8.1; this story adds re-init from new active DB |
| Modified `appMetaRepository.ts` | ✅ | Created by 8.1; this story adds full managed_databases CRUD |
| Modified `databaseSlice.ts` | ✅ | Created by 8.1; this story extends with full DB management state/thunks |
| Modified `SettingsScreen.tsx` | ✅ | Exists; this story adds catalog databases section |
| Design mockup | ✅ | `docs/design/grqaser-app/profile.html` — present with DB management section |

---

## 3. Acceptance criteria and tasks

| AC | Covered by tasks | Notes |
|----|------------------|--------|
| AC1: Load from internet | Tasks 1, 2, 3, 5 | databaseManager.loadDatabaseFromUrl(); appMetaRepository stores; databaseSlice async thunk; UI with URL input |
| AC2: Settings list DBs | Tasks 2, 5 | appMetaRepository.getAllManagedDatabases(); Settings UI shows name, size, date, active badge |
| AC3: Refresh alongside | Tasks 1, 3, 5 | databaseManager.refreshDatabase() downloads new copy with new ID; UI refresh button |
| AC4: Remove DBs (guard active) | Tasks 1, 2, 3, 5 | Guard in databaseManager and appMetaRepository; active DB cannot be removed; UI shows remove only for non-active |
| AC5: Reload on change | Task 4 | connection.ts close/reopen; catalogRepository re-init; booksSlice re-fetch; state cleared |
| AC6: No stale data | Task 4 | Cached data cleared; re-query from new DB; home/search/library/detail reflect new data |

---

## 4. Technical constraints

- **Dependency on 8.1:** Story explicitly requires database layer from Story 8.1 (connection.ts, catalogRepository.ts, appMetaRepository.ts, databaseSlice.ts, TypeScript types).
- **URL input:** Story specifies a text input dialog/modal for URL entry with format validation — straightforward React Native implementation.
- **DB connection lifecycle:** Task 4 requires closing and reopening SQLite connections. `react-native-sqlite-storage` supports `close()` and `openDatabase()` — standard API. Story correctly addresses this.
- **Catalog reload cascade:** After DB switch, all slices reading catalog data must re-fetch. Story specifies dispatching booksSlice reload, which is the primary consumer. Dev should ensure any other catalog-dependent state also reloads.

---

## 5. Summary

- **Implementation readiness:** **GO** — Story 8.3 is ready for the Dev agent.
- **Dependency:** Story 8.1 complete. Can be done in parallel with Story 8.2.
- **No blocking gaps.** All refs, paths, mockups, and schemas verified. DB management flow (load, list, refresh, remove, switch, reload) is comprehensively specified with safeguards.
